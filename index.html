<!DOCTYPE html>
<html>
<head>
    <title>QR-сканер</title>
</head>
<body>
    <div class="wrapper" style="display: flex; justify-content: center; align-items: center;">
        <video  id="video" width="50dvw" height="200px" autoplay></video>
        <p id="result"></p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@zxing/library@latest/umd/index.min.js"></script>
    <script>
        const video = document.getElementById('video');
        const resultElement = document.getElementById('result');
        let reader;

        async function startScanner() {
            reader = new ZXing.BrowserQRCodeReader();
            const formats = [
                ZXing.BarcodeFormat.QR_CODE
            ];
            const hints = new Map();
            hints.set(ZXing.DecodeHintType.POSSIBLE_FORMATS, formats);

            try {
                await reader.decodeFromVideoDevice(undefined, 'video', (result, err) => {
                    if (result) {
                        resultElement.textContent = result.text;
                        console.log('Данные из QR-кода:', result.text);
                        // reader.stop(); // Остановить после первого считывания
                    } else if (err && !(err instanceof ZXing.NotFoundException)) {
                        console.error('Ошибка сканирования:', err);
                    }
                });
            } catch (error) {
                console.error('Не удалось получить доступ к камере:', error);
                resultElement.textContent = 'Не удалось получить доступ к камере. Пожалуйста, дайте разрешение.';
            }
        }

        // Запуск сканера при загрузке страницы
        window.addEventListener('load', startScanner);
        
    </script>
</body>
</html>
